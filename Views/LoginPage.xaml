<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    x:Class="PaySecure.Views.LoginPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:PaySecure.ViewModels"
    x:DataType="vm:LoginViewModel"
    Title="{Binding Title}"
    Shell.NavBarIsVisible="False">

    <Grid>
        <!-- Fondo degradado -->
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#667eea" Offset="0.0" />
                <GradientStop Color="#764ba2" Offset="1.0" />
            </LinearGradientBrush>
        </Grid.Background>

        <ScrollView>
            <StackLayout Spacing="30" Padding="40,80,40,40">

                <!-- Logo y título -->
                <StackLayout Spacing="20" HorizontalOptions="Center">
                    <Frame 
                        BackgroundColor="White"
                        CornerRadius="40"
                        WidthRequest="80"
                        HeightRequest="80"
                        HasShadow="True">
                        <Label 
                            Text="💳"
                            FontSize="36"
                            HorizontalOptions="Center"
                            VerticalOptions="Center" />
                    </Frame>

                    <Label 
                        Text="PaySecure"
                        FontSize="32"
                        FontAttributes="Bold"
                        TextColor="White"
                        HorizontalOptions="Center" />

                    <Label 
                        Text="Pagos seguros con autenticación biométrica"
                        FontSize="16"
                        TextColor="#E0E0E0"
                        HorizontalOptions="Center"
                        HorizontalTextAlignment="Center" />
                </StackLayout>

                <!-- Formulario de login -->
                <Frame 
                    BackgroundColor="White"
                    CornerRadius="20"
                    Padding="30"
                    HasShadow="True">

                    <StackLayout Spacing="20">
                        <!-- Campo Email -->
                        <StackLayout>
                            <Label 
                                Text="Email"
                                FontSize="14"
                                TextColor="#666"
                                FontAttributes="Bold" />
                            <Entry 
                                Text="{Binding Email}"
                                Placeholder="Ingresa tu email"
                                Keyboard="Email"
                                BackgroundColor="#F5F5F5"
                                PlaceholderColor="#999" />
                        </StackLayout>

                        <!-- Botón login con email -->
                        <Button 
                            Text="Iniciar Sesión"
                            Command="{Binding LoginWithEmailCommand}"
                            BackgroundColor="#667eea"
                            TextColor="White"
                            CornerRadius="25"
                            HeightRequest="50"
                            FontAttributes="Bold" />

                        <!-- Separador -->
                        <StackLayout Orientation="Horizontal" Spacing="10" Margin="0,10">
                            <BoxView BackgroundColor="#E0E0E0" HeightRequest="1" VerticalOptions="Center" HorizontalOptions="FillAndExpand" />
                            <Label Text="O" TextColor="#999" VerticalOptions="Center" />
                            <BoxView BackgroundColor="#E0E0E0" HeightRequest="1" VerticalOptions="Center" HorizontalOptions="FillAndExpand" />
                        </StackLayout>

                        <!-- Botón biométrico -->
                        <Button 
                            Text="🔒 Usar Autenticación Biométrica"
                            Command="{Binding LoginWithBiometricCommand}"
                            BackgroundColor="#764ba2"
                            TextColor="White"
                            CornerRadius="25"
                            HeightRequest="50"
                            FontAttributes="Bold"
                            IsVisible="{Binding IsBiometricAvailable}" />

                        <!-- Mensaje de estado no disponible -->
                        <Frame 
                            BackgroundColor="#FFF3CD"
                            BorderColor="#FFE69C"
                            CornerRadius="10"
                            Padding="15"
                            IsVisible="{Binding IsBiometricAvailable, Converter={StaticResource InvertedBoolConverter}}">
                            <Label 
                                Text="⚠️ Autenticación biométrica no disponible en este dispositivo"
                                TextColor="#856404"
                                FontSize="12"
                                HorizontalTextAlignment="Center" />
                        </Frame>

                        <!-- Estado del login -->
                        <Label 
                            Text="{Binding LoginStatus}"
                            FontSize="14"
                            HorizontalOptions="Center"
                            HorizontalTextAlignment="Center"
                            IsVisible="{Binding LoginStatus, Converter={StaticResource StringIsNotNullOrEmptyConverter}}" />

                        <!-- Indicador de carga -->
                        <ActivityIndicator 
                            IsRunning="{Binding IsBusy}"
                            IsVisible="{Binding IsBusy}"
                            Color="#667eea" />
                    </StackLayout>
                </Frame>

                <!-- Información adicional -->
                <StackLayout Spacing="10">
                    <Label 
                        Text="✨ Características principales:"
                        TextColor="White"
                        FontAttributes="Bold"
                        HorizontalOptions="Center" />

                    <StackLayout Spacing="5">
                        <Label Text="• Gestión de transacciones con CRUD completo" TextColor="#E0E0E0" FontSize="12" />
                        <Label Text="• Autenticación biométrica segura" TextColor="#E0E0E0" FontSize="12" />
                        <Label Text="• Integración con Stripe para pagos" TextColor="#E0E0E0" FontSize="12" />
                        <Label Text="• Base de datos SQLite local" TextColor="#E0E0E0" FontSize="12" />
                    </StackLayout>
                </StackLayout>

            </StackLayout>
        </ScrollView>
    </Grid>
</ContentPage>